---
title: "p8105_hw5_ar4459_practice"
author: "ASHLEY ROMO"
date: "2023-11-04"
output: github_document
---
```{r}
library(tidyverse)
library(purrr)
```
 
## Problem 1


## Problem 2
```{r}
# loading data   
data = 
  tibble(
    files = list.files("data/"),
    path = str_c("data/", files)) |> 
    mutate(data = map(path, read_csv)) |> 
    unnest() 

# tidying data
data_clean = 
  data |> 
  mutate(
  subject_ID = str_extract(files, "\\d+"),
  tx_arm = str_extract(files, "con|exp")) |> 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    names_prefix = "week_",
    values_to =  "value") |> 
  select(subject_ID, tx_arm, week, value) |>
  mutate(week = as.numeric(week))

min(pull(data_clean |> filter(tx_arm == "con")))
```

Spaghetti plot
```{r}
plot = 
  data_clean |> 
  ggplot(aes(x = week, y = value, color = subject_ID)) +
  geom_line() +
  facet_wrap(~tx_arm) +
  labs(
    x = "Week",
    y = "Values",
    color = "Subject ID",
    title = "Observations For Each Subject Over Time"
  )

plot
```
The spaghetti plot shows that the control group has lower values than the experimental group. The control group appreas to stay between -2.5 and 5 while the experimental group increases over time. The mean value for the control group is `r mean(pull(data_clean |> filter(tx_arm == "con")))` and the mean value for the experimental group is `r mean(pull(data_clean |> filter(tx_arm == "exp")))`. The minimum value for the control group is `r min(pull(data_clean |> filter(tx_arm == "con")))` and the miniumum value for the treatment group is `r min(pull(data_clean |> filter(tx_arm == "exp")))`. The maximum value for the control group is `r max(pull(data_clean |> filter(tx_arm == "con")))` and the maximum value for the experimental group is `r max(pull(data_clean |> filter(tx_arm == "exp")))`.

## Problem 3

```{r}
# generate data
t_test_sim = function(n = 30, mu = 0, sigma = 5) {
  
  data = 
    tibble(
      x = rnorm(n = n, mean = mu, sd = sigma)
    )
  
  t_test = 
    t.test(data, mean = 0, conf.level = 0.95) |> 
    broom::tidy()
}
```

```{r}
# Generate 5000 datasets from the model

output = vector("list", 5000)

for (i in 5000) {
  output[[i]] = t_test_sim(30)
}

sim_results = bind_rows(output)
```

